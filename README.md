## <center>Домашно2 ИИ - KNN Clasification</center>



## Описание на проблема

Алгоритъмът **k-NN** (K Nearest Neighbours) e алгоритъм, който може да се използва както за *класификация*, така и за *регресия*. В този документ ще обясня как съм използвал **k-NN** за да реша следната задача.

#### Задача

Дадено е множество от обучаващи примери, включващи данни за профили на клиенти на фирма. Примерите включват данни за: 

* сумата от разходите, осъществени от клиента (на тримесечна основа, в хил. лв.)
* честотата на извършване на покупки
*  вида на извършените покупки (0 – покупки от стандартната ценова листа, 1 – покупки от специалните оферти в каталога на фирмата).

| Осъществени разходи на клиентите (в хил. лв.) | Честота на покупките | Покупки с намаление (от специални оферти) - да или не |
| --------------------------------------------- | -------------------- | ----------------------------------------------------- |
| 982                                           | Very often           | 0                                                     |
| 1304                                          | Very often           | 1                                                     |
| 1256                                          | Very often           | 1                                                     |
| 1562                                          | Very often           | 0                                                     |
| 703                                           | Very often           | 0                                                     |
| 1569                                          | Rarely               | 0                                                     |
| 978                                           | Sometimes            | 1                                                     |
| 1377                                          | Often                | 1                                                     |

Задачата на всеки от вас е да разработи програмна система, която да получава данни за очакваните тримесечни разходи и честота на покупките на нов клиент на  фирмата и да предвижда вида на неговите покупки (ще търси специални оферти или ше се насочи към стандартната ценова листа), като за целта прилага метода на k найблизки съседи (k-NN).



## Реализация ( JavaScript )

Първото нещо, което трябва да бъде направено е да се конвертират *категорните* стойности за *честота на покупките* към **числа**.
Идеята за да запазя тежестта на категорната променлива **Честота на покупките** е да я съотенса право пропоционално с променливата **Осъществени разходи на клиентите (в хил. лв.)**. Това се случва по следния начин:

```javascript
const convertFrequenciesToNumbers = (clients) => {
    const amounts = clients.map(el => el.amount);
    const max = Math.max(...amounts);
    const min = Math.min(...amounts);
    const step = (max - min) / 3;
    const map = {
        "Rarely" : min,
        "Sometimes" : min + step,
        "Often" : min + 2 * step,
        "Very often" : max
    };

    return map;
};
```

Така мога да си дефинирам разстояние между точки, използвайки *Euclidian Distance* по следния начин.

*Distance(client1, client2) = sqrt((client1.amount - client2.amount)^2 + (client1.frequency - client2.frequency)^2)*,
където client1 и client2 са клиенти (редове от файла) и *client.frequency* е преобразувано по показания по-горе начин.

След това използвайки това разстояние се сортират всички клиенти спрямо конкретно **entry** ( точка ).
След това се взимат първите К елемента от сортираните клиенти, където К е параметър на функцията и спрямо тях се класифицира **entry**-то ( мода на елементите спрямо 3тата променлива **окупки с намаление (от специални оферти) - да или не**).

**Наблюдение:** При по-малките стойности ( < 10 ) за *параметъра К*, алгоритъмът класифицира точките с доста висока точност (80% - 100%). Ако трябва да се даде точна стойност на **К** , бих казал че К = 5 дава най-точни резултати. Това наблюдение е направено след провеждането на много тестове, които са визуализирани и можете да се убедите и сами.



## Визуализация 

![image-20210606182820306](C:\Users\Alex\AppData\Roaming\Typora\typora-user-images\image-20210606182820306.png)

Направил съм проста визуализация на данните използвайки HTML. 

* **Starting Dataset**: Визуализация на началните данни ( тези от файла ), най-вляво

* **Operations** : Има две операции с които може да се тества 

  * Класифициране на точка. Въвеждат се следните данни:

    * Сума : *Осъществени разходи на клиентите (в хил. лв.)*
    * Честота
    * Стойност на параметъра **К**, за който искате да тествате.

    След това се натиска бутонът **Класифицирай** и до него се изписва *Отговор : Да / Не*, тоест дали този клиент ще купува от специални оферти или не.

  * Произволно тестване. Идеята е следната:

    * Избират се произволни 25 % от **Starting Dataset**, които да бъдат тествани, а останлите 75% са за тренировка на алгоритъма.
    * За всяко **К** в интервала [1.. 40] се правят по **1000** опита за класифициране на всеки един тестови запис и при всеки един опит се измерва колко от тестовите записи са класифицирани правилно.
    * Накрая се зареждат таблиците под **Testing Dataset**, където първата таблица показва <u>успеваемостта на алгоритъма</u> за всяка стойност на **К**, а в дясната се покзва, кои записи от **Starting Dataset** са били избрани за тестови (оцветени в зелено). 